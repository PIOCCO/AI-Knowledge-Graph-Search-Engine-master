<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.example.controller.MainController"
            styleClass="root">

    <!-- LEFT SIDEBAR -->
    <left>
        <VBox styleClass="sidebar" spacing="0">
            <!-- Logo/Header -->
            <VBox styleClass="sidebar-header" alignment="CENTER">
                <Label text="ðŸŽ« TeamSupport" styleClass="sidebar-logo"/>
            </VBox>

            <Separator styleClass="sidebar-separator"/>

            <!-- Navigation Menu -->
            <VBox styleClass="sidebar-menu" VBox.vgrow="ALWAYS">
                <!-- Main Section -->
                <Label text="MAIN" styleClass="sidebar-section-title"/>

                <Button fx:id="btnDashboard" text="ðŸ“Š  Dashboard"
                        styleClass="sidebar-item active"
                        onAction="#handleDashboard" maxWidth="Infinity"/>

                <Button fx:id="btnTickets" text="ðŸŽ«  My Tickets"
                        styleClass="sidebar-item"
                        onAction="#handleTickets" maxWidth="Infinity"/>

                <Button text="ðŸ“  All Tickets"
                        styleClass="sidebar-item"
                        onAction="#handleAllTickets" maxWidth="Infinity"/>

                <!-- Management Section -->
                <Label text="MANAGEMENT" styleClass="sidebar-section-title">
                    <VBox.margin>
                        <Insets top="10"/>
                    </VBox.margin>
                </Label>

                <Button fx:id="btnNewTicket" text="âž•  New Ticket"
                        styleClass="sidebar-item"
                        onAction="#handleNewTicket" maxWidth="Infinity"/>

                <Button fx:id="btnCategories" text="ðŸ“  Categories"
                        styleClass="sidebar-item"
                        onAction="#handleCategories" maxWidth="Infinity"/>

                <Button fx:id="btnUsers" text="ðŸ‘¥  Users"
                        styleClass="sidebar-item"
                        onAction="#handleUsers" maxWidth="Infinity"/>

                <Button text="ðŸ“Š  Reports"
                        styleClass="sidebar-item"
                        onAction="#handleReports" maxWidth="Infinity"/>

                <Button text="ðŸ“Š  Stats"
                        styleClass="sidebar-item"
                        onAction="#handleOpenStats"
                        maxWidth="Infinity"/>

                <!-- Spacer to push settings to bottom -->
                <Region VBox.vgrow="ALWAYS"/>

                <!-- Settings at Bottom -->
                <Separator styleClass="sidebar-separator">
                    <VBox.margin>
                        <Insets bottom="5"/>
                    </VBox.margin>
                </Separator>

                <Button text="âš™ï¸  Settings"
                        styleClass="sidebar-item"
                        onAction="#handleSettings" maxWidth="Infinity"/>

                <Button text="ðŸšª  Logout"
                        styleClass="sidebar-item"
                        onAction="#handleLogout" maxWidth="Infinity"/>
            </VBox>
        </VBox>
    </left>

    <!-- MAIN CONTENT AREA -->
    <center>
        <VBox spacing="0">
            <!-- TOP HEADER -->
            <HBox styleClass="top-header" alignment="CENTER_LEFT" spacing="20">
                <Label fx:id="lblPageTitle" text="Dashboard" styleClass="header-title"/>

                <Region HBox.hgrow="ALWAYS"/>

                <TextField fx:id="searchField" promptText="ðŸ” Search tickets..."
                           styleClass="header-search" onAction="#handleSearch"/>

                <VBox styleClass="user-info" alignment="CENTER_RIGHT" spacing="2">
                    <Label fx:id="lblUsername" text="Admin User" styleClass="user-name"/>
                    <Label fx:id="lblUserRole" text="Administrator" styleClass="user-role"/>
                </VBox>
            </HBox>

            <!-- TOOLBAR (visible on certain pages) -->
            <HBox fx:id="toolbarContainer" styleClass="toolbar" alignment="CENTER_LEFT"
                  spacing="12" visible="false" managed="false">
                <Button text="New Ticket" styleClass="btn-new-ticket"
                        onAction="#handleNewTicket"/>

                <ComboBox fx:id="statusFilter" promptText="Status: All"
                          styleClass="filter-combo" prefWidth="150"/>

                <ComboBox fx:id="priorityFilter" promptText="Severity: All"
                          styleClass="filter-combo" prefWidth="150"/>

                <Region HBox.hgrow="ALWAYS"/>

                <Button text="ðŸ”„ Refresh" styleClass="btn-secondary"
                        onAction="#handleRefresh"/>

                <Button text="â‹® More" styleClass="btn-secondary"/>
            </HBox>

            <!-- CONTENT AREA -->
            <StackPane VBox.vgrow="ALWAYS">
                <!-- Dashboard View -->
                <ScrollPane fitToWidth="true" fx:id="dashboardView" visible="true">
                    <VBox styleClass="content-area" spacing="20">
                        <!-- Stats Cards -->
                        <HBox styleClass="stats-container" spacing="15">
                            <VBox styleClass="stat-card" spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="TOTAL TICKETS" styleClass="stat-label"/>
                                <Label fx:id="lblTotalTickets" text="248" styleClass="stat-value"/>
                                <Label text="+12 from last week" styleClass="stat-change positive"/>
                            </VBox>

                            <VBox styleClass="stat-card" spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="OPEN" styleClass="stat-label"/>
                                <Label fx:id="lblOpenTickets" text="42" styleClass="stat-value"/>
                                <Label text="Pending resolution" styleClass="stat-change"/>
                            </VBox>

                            <VBox styleClass="stat-card" spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="IN PROGRESS" styleClass="stat-label"/>
                                <Label fx:id="lblProgressTickets" text="18" styleClass="stat-value"/>
                                <Label text="Being worked on" styleClass="stat-change"/>
                            </VBox>

                            <VBox styleClass="stat-card" spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="RESOLVED" styleClass="stat-label"/>
                                <Label fx:id="lblResolvedTickets" text="188" styleClass="stat-value"/>
                                <Label text="This month: 45" styleClass="stat-change positive"/>
                            </VBox>
                        </HBox>

                        <!-- Recent Tickets Section -->
                        <VBox spacing="10">
                            <Label text="Recent Tickets" styleClass="page-title"/>

                            <VBox>
                                <TableView fx:id="recentTicketsTable" styleClass="tickets-table">
                                    <columns>
                                        <TableColumn text="â˜" prefWidth="40" styleClass="checkbox-cell"/>
                                        <TableColumn fx:id="colTicketId" text="Number" prefWidth="100"/>
                                        <TableColumn fx:id="colTitle" text="Name" prefWidth="300"/>
                                        <TableColumn fx:id="colStatus" text="Status" prefWidth="120"/>
                                        <TableColumn fx:id="colPriority" text="Severity" prefWidth="100"/>
                                        <TableColumn fx:id="colCategory" text="Type" prefWidth="120"/>
                                        <TableColumn fx:id="colAssignedTo" text="Group" prefWidth="150"/>
                                        <TableColumn fx:id="colCreatedAt" text="Days Opened" prefWidth="120"/>
                                    </columns>
                                </TableView>

                                <!-- Pagination -->
                                <HBox styleClass="pagination-bar" alignment="CENTER_LEFT" spacing="15">
                                    <Label text="17 Tickets" styleClass="pagination-text"/>
                                    <Region HBox.hgrow="ALWAYS"/>
                                    <Label text="1-10 of 17" styleClass="pagination-text"/>
                                    <Button text="â—€" styleClass="pagination-button"/>
                                    <Button text="â–¶" styleClass="pagination-button"/>
                                </HBox>
                            </VBox>
                        </VBox>
                    </VBox>
                </ScrollPane>

                <!-- All Tickets View -->
                <ScrollPane fitToWidth="true" fx:id="ticketsView" visible="false">
                    <VBox styleClass="content-area" spacing="10">
                        <Label text="All Tickets" styleClass="page-title"/>

                        <VBox>
                            <TableView fx:id="allTicketsTable" styleClass="tickets-table">
                                <columns>
                                    <TableColumn text="â˜" prefWidth="40"/>
                                    <TableColumn fx:id="colAllTicketId" text="Number" prefWidth="100"/>
                                    <TableColumn fx:id="colAllTitle" text="Name" prefWidth="300"/>
                                    <TableColumn fx:id="colAllStatus" text="Status" prefWidth="120"/>
                                    <TableColumn fx:id="colAllPriority" text="Severity" prefWidth="100"/>
                                    <TableColumn fx:id="colAllCategory" text="Type" prefWidth="120"/>
                                    <TableColumn fx:id="colAllAssignedTo" text="Group" prefWidth="150"/>
                                    <TableColumn fx:id="colAllCreatedAt" text="Days" prefWidth="80"/>
                                    <TableColumn fx:id="colAllActions" text="" prefWidth="80"/>
                                </columns>
                                <placeholder>
                                    <VBox styleClass="empty-state" spacing="15">
                                        <Label text="ðŸŽ«" styleClass="empty-icon"/>
                                        <Label text="No tickets found" styleClass="empty-text"/>
                                    </VBox>
                                </placeholder>
                            </TableView>

                            <!-- Pagination -->
                            <HBox styleClass="pagination-bar" alignment="CENTER_LEFT" spacing="15">
                                <Label text="17 Tickets" styleClass="pagination-text"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label text="1-10 of 17" styleClass="pagination-text"/>
                                <Button text="â—€" styleClass="pagination-button"/>
                                <Button text="â–¶" styleClass="pagination-button"/>
                            </HBox>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </StackPane>
        </VBox>
    </center>
</BorderPane>